{%- comment -%}
  Modern Features Grid
  ====================
  USP grid with icons, text, hover animations, and responsive 2-6 column layout.
{%- endcomment -%}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .modern-features__header {
    text-align: center;
    margin-bottom: var(--space-3xl);
    max-width: 600px;
    margin-inline: auto;
  }
  .modern-features__title {
    font-size: var(--text-3xl);
    font-weight: 700;
    margin: 0;
    letter-spacing: var(--tracking-tight);
  }
  .modern-features__subtitle {
    font-size: var(--text-base);
    opacity: 0.6;
    margin: var(--space-md) 0 0;
  }

  .modern-features-grid {
    display: grid;
    gap: var(--space-xl);
    grid-template-columns: repeat(2, 1fr);
  }
  @media screen and (min-width: 750px) {
    .modern-features-grid {
      grid-template-columns: repeat({{ section.settings.columns_desktop | at_most: 3 }}, 1fr);
    }
  }
  @media screen and (min-width: 990px) {
    .modern-features-grid {
      grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr);
    }
  }

  .modern-feature-card {
    text-align: {{ section.settings.text_alignment }};
    padding: var(--space-2xl);
    border-radius: var(--radius-xl);
    transition: all var(--duration-fast) var(--ease-out);
  }
  .modern-feature-card--bordered {
    border: 1px solid rgba(128,128,128,0.1);
  }
  .modern-feature-card--filled {
    background: rgba(128,128,128,0.04);
  }
  .modern-feature-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }

  .modern-feature-card__icon {
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-lg);
    transition: transform var(--duration-fast) var(--ease-out);
  }
  .modern-feature-card__icon--filled {
    background: var(--color-button, #000);
    color: var(--color-button-text, #fff);
  }
  .modern-feature-card__icon--outline {
    border: 2px solid rgba(128,128,128,0.2);
  }
  .modern-feature-card:hover .modern-feature-card__icon {
    transform: scale(1.1);
  }
  .modern-feature-card__icon svg { width: 28px; height: 28px; }
  .modern-feature-card__icon img { width: 28px; height: 28px; object-fit: contain; }

  .modern-feature-card__title {
    font-size: var(--text-lg);
    font-weight: 600;
    margin: 0 0 var(--space-sm);
  }
  .modern-feature-card__text {
    font-size: var(--text-sm);
    opacity: 0.6;
    line-height: var(--leading-relaxed);
    margin: 0;
  }

  {%- if section.settings.text_alignment == 'center' -%}
    .modern-feature-card__icon { margin-inline: auto; }
  {%- endif -%}
{%- endstyle -%}

<div class="color-{{ section.settings.color_scheme }} gradient">
  <div class="page-width section-{{ section.id }}-padding">
    {%- if section.settings.title != blank or section.settings.subtitle != blank -%}
      <div class="modern-features__header modern-animate animate--fade-up">
        {%- if section.settings.title != blank -%}
          <h2 class="modern-features__title">{{ section.settings.title }}</h2>
        {%- endif -%}
        {%- if section.settings.subtitle != blank -%}
          <p class="modern-features__subtitle">{{ section.settings.subtitle | escape }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}

    <div class="modern-features-grid">
      {%- for block in section.blocks -%}
        <div class="modern-feature-card modern-feature-card--{{ section.settings.card_style }} modern-animate animate--fade-up" data-stagger="{{ forloop.index | modulo: 8 | plus: 1 }}" {{ block.shopify_attributes }}>
          <div class="modern-feature-card__icon modern-feature-card__icon--{{ section.settings.icon_style }}">
            {%- if block.settings.custom_icon != blank -%}
              {{ block.settings.custom_icon | image_url: width: 56 | image_tag: alt: block.settings.title, loading: 'lazy' }}
            {%- else -%}
              {%- case block.settings.icon -%}
                {%- when 'shipping' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"/></svg>
                {%- when 'shield' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                {%- when 'heart' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                {%- when 'star' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>
                {%- when 'refresh' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
                {%- when 'clock' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                {%- when 'globe' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                {%- when 'leaf' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>
                {%- else -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>
              {%- endcase -%}
            {%- endif -%}
          </div>
          <h3 class="modern-feature-card__title">{{ block.settings.title | escape }}</h3>
          {%- if block.settings.text != blank -%}
            <p class="modern-feature-card__text">{{ block.settings.text | escape }}</p>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Modern Features Grid",
  "tag": "section",
  "class": "section-modern-features-grid",
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "shipping", "label": "Shipping" },
            { "value": "shield", "label": "Shield" },
            { "value": "heart", "label": "Heart" },
            { "value": "star", "label": "Star" },
            { "value": "refresh", "label": "Refresh" },
            { "value": "clock", "label": "Clock" },
            { "value": "globe", "label": "Globe" },
            { "value": "leaf", "label": "Leaf" }
          ],
          "default": "star"
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom icon image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feature Title"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Description",
          "default": "Describe this feature and why it matters to your customers."
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Why Choose Us"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 3,
      "label": "Desktop columns"
    },
    {
      "type": "select",
      "id": "card_style",
      "label": "Card style",
      "options": [
        { "value": "none", "label": "No background" },
        { "value": "bordered", "label": "Bordered" },
        { "value": "filled", "label": "Filled" }
      ],
      "default": "filled"
    },
    {
      "type": "select",
      "id": "icon_style",
      "label": "Icon style",
      "options": [
        { "value": "filled", "label": "Filled" },
        { "value": "outline", "label": "Outline" }
      ],
      "default": "filled"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" }
      ],
      "default": "center"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 52,
      "unit": "px",
      "label": "Padding top"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 52,
      "unit": "px",
      "label": "Padding bottom"
    }
  ],
  "presets": [
    {
      "name": "Modern Features Grid",
      "blocks": [
        { "type": "feature", "settings": { "icon": "shipping", "title": "Free Shipping", "text": "Free shipping on all orders over $50." } },
        { "type": "feature", "settings": { "icon": "shield", "title": "Secure Payment", "text": "Your payment information is safe with us." } },
        { "type": "feature", "settings": { "icon": "refresh", "title": "Easy Returns", "text": "30-day hassle-free return policy." } },
        { "type": "feature", "settings": { "icon": "heart", "title": "Premium Quality", "text": "Crafted with care from the finest materials." } }
      ]
    }
  ]
}
{% endschema %}
